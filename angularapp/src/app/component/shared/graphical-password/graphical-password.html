<div class="graphical-password-container">
  <div class="header-section">
    <h3 *ngIf="mode === 'setup'">Create Your Graphical Password</h3>
    <h3 *ngIf="mode === 'verify'">Enter Your Graphical Password</h3>
    <p class="instruction-text">
      Select {{ requiredSelections }} images in your preferred sequence. 
      <span *ngIf="mode === 'setup'">You'll need to remember this sequence for future logins.</span>
    </p>
  </div>

  <div class="selection-info">
    <div class="selection-counter">
      <span class="counter-label">Selected:</span>
      <span class="counter-value">{{ getSelectionCount() }} / {{ requiredSelections }}</span>
    </div>
    <div class="remaining-selections" *ngIf="getRemainingSelections() > 0">
      <span class="remaining-text">{{ getRemainingSelections() }} more image(s) needed</span>
    </div>
  </div>

  <div class="error-message" *ngIf="errorMessage">
    <span class="error-icon">‚ö†Ô∏è</span>
    {{ errorMessage }}
  </div>

  <div class="image-grid">
    <div 
      *ngFor="let imageId of imageGrid" 
      class="image-cell"
      [class.selected]="selectedImages.includes(imageId)"
      [class.complete]="isComplete"
      (click)="selectImage(imageId)"
    >
      <img 
        [src]="getImageUrl(imageId)" 
        [alt]="'Image ' + imageId"
        class="grid-image"
        loading="lazy"
      />
      <div class="selection-number" *ngIf="selectedImages.includes(imageId)">
        {{ selectedImages.indexOf(imageId) + 1 }}
      </div>
      <div class="selection-overlay"></div>
    </div>
  </div>

  <div class="selected-sequence" *ngIf="selectedImages.length > 0">
    <h4>Your Selection Sequence:</h4>
    <div class="sequence-display">
      <div 
        *ngFor="let imageId of selectedImages; let i = index" 
        class="sequence-item"
      >
        <span class="sequence-number">{{ i + 1 }}</span>
        <img 
          [src]="getImageUrl(imageId)" 
          [alt]="'Selected image ' + (i + 1)"
          class="sequence-image"
        />
      </div>
    </div>
  </div>

  <div class="action-buttons">
    <button 
      type="button" 
      class="btn-clear" 
      (click)="removeLastSelection()"
      [disabled]="selectedImages.length === 0"
    >
      ‚Ü∂ Undo Last
    </button>
    <button 
      type="button" 
      class="btn-reset" 
      (click)="clearAll()"
      [disabled]="selectedImages.length === 0"
    >
      ‚Üª Clear All
    </button>
  </div>

  <div class="security-note">
    <span class="security-icon">üîí</span>
    <p>Your graphical password is encrypted and stored securely. Make sure to remember your image sequence.</p>
  </div>
</div>



