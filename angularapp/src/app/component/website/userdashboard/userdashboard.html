<div class="dashboard-container">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="loading-spinner"></div>
    <p>Loading your dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-message">
    <p>{{ error }}</p>
  </div>

  <!-- Sidebar -->
  <aside class="sidebar">
    <!-- NeoBank Title -->
    <div class="brand-section">
      <div class="brand-logo">
        <img src="/favicon.ico" alt="NeoBank Logo" class="logo-image">
      </div>
      <span class="brand-name">NeoBank</span>
    </div>

    <!-- Navigation -->
    <nav class="navigation">
      <ul class="nav-list">
        <li class="nav-item">
          <a (click)="selectFeature('transferfunds')" 
             [class.active]="selectedFeature === 'transferfunds'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">Transfer Funds</span>
          </a>
        </li>
        <li class="nav-item">
          <a (click)="selectFeature('card')" 
             [class.active]="selectedFeature === 'card'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">Card</span>
          </a>
        </li>
        <li class="nav-item">
          <a (click)="selectFeature('transaction')" 
             [class.active]="selectedFeature === 'transaction'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">Transactions</span>
          </a>
        </li>
        <li class="nav-item">
          <a (click)="selectFeature('kycupdate')" 
             [class.active]="selectedFeature === 'kycupdate'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">KYC Update</span>
          </a>
        </li>
        <li class="nav-item">
          <a (click)="selectFeature('loan')" 
             [class.active]="selectedFeature === 'loan'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">Loans</span>
          </a>
        </li>
        <li class="nav-item">
          <a (click)="selectFeature('cheque')" 
             [class.active]="selectedFeature === 'cheque'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">Cheque</span>
          </a>
        </li>
        <li class="nav-item">
          <a (click)="selectFeature('goldloan')" 
             [class.active]="selectedFeature === 'goldloan'"
             class="nav-link">
            <span class="nav-icon"></span>
            <span class="nav-text">Gold Loan</span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Header -->
    <header class="main-header">
      <div class="header-content">
        <h1 class="welcome-title">Welcome {{ username }} üè¶</h1>
        <div class="header-actions">
          <div class="balance-display">
            <span class="balance-label">Balance:</span>
            <span class="balance-amount">‚Çπ{{ currentBalance | number:'1.2-2' }}</span>
          </div>
          <button (click)="goToProfile()" class="profile-btn"> Profile</button>
          <button (click)="logout()" class="logout-btn">Logout</button>
        </div>
      </div>
    </header>

    <!-- Content Area -->
    <div class="content-area">
      <div *ngIf="!selectedFeature" class="welcome-message">
        <div class="welcome-card">
          <h2>Welcome to NeoBank Dashboard</h2>
          <p>Select a feature from the sidebar to get started</p>
          
          <!-- QR Code Section -->
          <div class="qr-section">
            <div class="qr-actions">
              <button class="qr-btn receive-btn" (click)="generateQrCode()" [disabled]="isGeneratingQr">
                <span class="qr-icon">üì±</span>
                <span>{{ isGeneratingQr ? 'Generating...' : 'Show My QR Code' }}</span>
              </button>
              <button class="qr-btn scan-btn" (click)="startQrScanner()" [disabled]="isScanning">
                <span class="qr-icon">üì∑</span>
                <span>{{ isScanning ? 'Scanning...' : 'Scan QR Code' }}</span>
              </button>
            </div>
            
            <!-- QR Code Display -->
            <div *ngIf="showQrCode" class="qr-display">
              <div class="qr-header">
                <h3>Scan to Pay via UPI</h3>
                <button class="close-btn" (click)="closeQrCode()">√ó</button>
              </div>
              <div class="qr-image-container">
                <img [src]="qrCodeImage" alt="UPI QR Code" class="qr-image">
              </div>
              <div class="qr-info">
                <p class="upi-id">UPI ID: <strong>{{ upiId }}</strong></p>
                <p *ngIf="qrAmount > 0" class="qr-amount">Amount: <strong>‚Çπ{{ qrAmount | number:'1.2-2' }}</strong></p>
                <p *ngIf="qrAmount === 0" class="qr-amount">Dynamic Amount</p>
                <p class="qr-instruction">Scan with PhonePe, Google Pay, or any UPI app</p>
              </div>

            </div>
            
            <!-- QR Scanner -->
            <div *ngIf="showQrScanner" class="qr-scanner">
              <div class="qr-header">
                <h3>Scan QR Code to Pay</h3>
                <button class="close-btn" (click)="stopQrScanner()">√ó</button>
              </div>
              <div id="qr-reader" class="qr-reader-container"></div>
              <p class="qr-instruction">Point your camera at a UPI QR code</p>
            </div>
          </div>
          
          <div class="feature-grid">
            <div class="feature-card" (click)="selectFeature('transferfunds')">
              <span class="feature-icon">üí∏</span>
              <h3>Transfer Funds</h3>
              <p>Send money to other accounts</p>
            </div>
            <div class="feature-card" (click)="selectFeature('card')">
              <span class="feature-icon">üí≥</span>
              <h3>Card Management</h3>
              <p>Manage your cards</p>
            </div>
            <div class="feature-card" (click)="selectFeature('transaction')">
              <span class="feature-icon">üîÑ</span>
              <h3>Transactions</h3>
              <p>View transaction history</p>
            </div>
            <div class="feature-card" (click)="selectFeature('kycupdate')">
              <span class="feature-icon">üìë</span>
              <h3>KYC Update</h3>
              <p>Update your information</p>
            </div>
            <div class="feature-card" (click)="selectFeature('loan')">
              <span class="feature-icon">üí∞</span>
              <h3>Loans</h3>
              <p>Apply for loans</p>
            </div>
            <div class="feature-card" (click)="selectFeature('cheque')">
              <span class="feature-icon">üìù</span>
              <h3>Cheque</h3>
              <p>Manage cheque leaves</p>
            </div>
            <div class="feature-card" (click)="selectFeature('goldloan')">
              <span class="feature-icon">ü•á</span>
              <h3>Gold Loan</h3>
              <p>Apply for gold loan</p>
            </div>
          </div>
        </div>
      </div>
      
      <div *ngIf="selectedFeature" class="feature-content">
        <div class="feature-header">
          <h2>{{ getFeatureTitle() }}</h2>
          <button (click)="goTo(selectedFeature)" class="action-btn">Open Full Page</button>
        </div>
        <div class="feature-preview">
          <p>{{ getFeatureDescription() }}</p>
          <div class="preview-content">
            <div class="preview-placeholder">
              <span class="preview-icon">{{ getFeatureIcon() }}</span>
              <p>Click "Open Full Page" to access {{ getFeatureTitle() }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
