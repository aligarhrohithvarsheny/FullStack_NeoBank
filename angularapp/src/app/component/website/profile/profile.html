<div class="profile-container">
  <div class="profile-header">
    <button class="back-btn" (click)="goBack()">← Back to Dashboard</button>
    <h2>My Profile</h2>
  </div>

  <div class="profile-content">
    <!-- Profile Card -->
    <div class="profile-card">
      <div class="profile-avatar">
        <div class="avatar-circle">
          <span class="avatar-text">{{ userProfile.name.charAt(0) }}</span>
        </div>
      </div>
      
      <div class="profile-info">
        <h3>{{ userProfile.name }}</h3>
        <p class="account-type">{{ userProfile.accountType }}</p>
        <p class="account-number">Account: {{ userProfile.accountNumber }}</p>
      </div>

      <div class="balance-section">
        <div class="balance-card">
          <h4>Current Balance</h4>
          <p class="balance-amount">₹{{ currentBalance | number:'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <!-- Personal Details -->
    <div class="details-section">
      <h3>Personal Information</h3>
      <div class="details-grid">
        <div class="detail-item">
          <label>Full Name</label>
          <p>{{ userProfile.name }}</p>
        </div>
        <div class="detail-item">
          <label>Email Address</label>
          <div *ngIf="!editingEmail" class="email-display">
            <p>{{ userProfile.email }}</p>
            <button class="edit-email-btn" (click)="startEditingEmail()" type="button">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
              Update
            </button>
          </div>
          <div *ngIf="editingEmail" class="email-edit">
            <input 
              type="email" 
              [(ngModel)]="newEmail" 
              class="email-input"
              placeholder="Enter new email"
              [disabled]="updatingEmail"
            />
            <div class="email-error" *ngIf="emailError">{{ emailError }}</div>
            <div class="email-actions">
              <button 
                class="save-email-btn" 
                (click)="updateEmail()" 
                [disabled]="updatingEmail"
                type="button"
              >
                <span *ngIf="!updatingEmail">Save</span>
                <span *ngIf="updatingEmail">Updating...</span>
              </button>
              <button 
                class="cancel-email-btn" 
                (click)="cancelEditingEmail()" 
                [disabled]="updatingEmail"
                type="button"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
        <div class="detail-item">
          <label>Account Number</label>
          <p>{{ userProfile.accountNumber }}</p>
        </div>
        <div class="detail-item">
          <label>IFSC Code</label>
          <p>{{ userProfile.ifscCode }}</p>
        </div>
        <div class="detail-item">
          <label>Phone Number</label>
          <p>{{ userProfile.phoneNumber || 'Not provided' }}</p>
        </div>
        <div class="detail-item">
          <label>Date of Birth</label>
          <p>{{ userProfile.dateOfBirth || 'Not provided' }}</p>
        </div>
        <div class="detail-item">
          <label>Address</label>
          <p>{{ userProfile.address || 'Not provided' }}</p>
        </div>
        <div class="detail-item">
          <label>Account Type</label>
          <p>{{ userProfile.accountType }}</p>
        </div>
        <div class="detail-item">
          <label>Member Since</label>
          <p>{{ userProfile.joinDate }}</p>
        </div>
        <div class="detail-item" *ngIf="userProfile.pan">
          <label>PAN Number</label>
          <p>{{ userProfile.pan }}</p>
        </div>
        <div class="detail-item" *ngIf="userProfile.aadhar">
          <label>Aadhar Number</label>
          <p>{{ userProfile.aadhar }}</p>
        </div>
        <div class="detail-item" *ngIf="userProfile.occupation">
          <label>Occupation</label>
          <p>{{ userProfile.occupation }}</p>
        </div>
        <div class="detail-item" *ngIf="userProfile.income">
          <label>Annual Income</label>
          <p>₹{{ userProfile.income | number:'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="edit-btn" (click)="editProfile()">Edit Profile</button>
      <button class="refresh-btn" (click)="loadCurrentBalance()">Refresh Balance</button>
    </div>
  </div>
</div>
